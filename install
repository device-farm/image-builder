#!/bin/bash
set -e

#DOCKER_IMAGE=defa/rpi-2-b
#DOCKER_IMAGE=defa/orangepi-zero
#DOCKER_IMAGE=defa/nanopi-duo
#DOCKER_IMAGE=defa/qemu_x86_64

# docker run \
#     --rm \
#     -it \
#     -e INSTALL_DEVICE=/dev/mmcblk0 \
#     -v /dev:/build/host/dev \
#     -v $(pwd)/custom-root:/build/custom-root \
#     -v $(pwd)/custom-dto:/build/custom-dto \
#     --privileged \
#     $DOCKER_IMAGE

docker run --rm -it --volume=/dev:/build/host/dev --env=INSTALL_DEVICE=/dev/mmcblk0 --env=CONFIG_HOSTNAME=p56vf2nk --env=CONFIG_WG_DEVICE_ADDR=10.128.1.2 --env=CONFIG_WG_DEVICE_MASK=10 --env=CONFIG_WG_SERVER_PUBLIC_KEY=AMZrfws9qjWIQa4+LIE0/k87rY3CowWg3OtK0zUcrVk= --env=CONFIG_WG_SERVER_HOST=wireguard.device.farm --env=CONFIG_WG_SERVER_PORT=1166 --env=CONFIG_WIFI_SSID=NDE2VA== --env=CONFIG_WIFI_PASSWORD=ZmVyZGFtcmF2ZW5lYw== --env=CONFIG_SSH_AUTHORIZED_KEYS=c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBQkl3QUFBUUVBd3dmVGdSMXJUTXEzUjR4bmw0Z3RiVStTMjN6YVhiOFczdmJGMnZKS3FKNkIyS0s3YzVKcnY1NTR6TVd3aWgwbWNqVERXanpNdUlza3JuTDlCY0JQRTlKUzd5UVNhWUx1U3FCaWFRWWU5WUZTaGp4dGk0dStONE9zdjJPLzA2NWtXZWIzNVYySmN1RDFmK1lLNmFnamtrc0syeVhzdWdrY1hmV2lsaWMzaGxpUEN6cXI0aTJUSGt1enZtSVR1NGlCanhEZUlxdit3cmgyWXY0WUhxVHhEWW5vY1FQSXpNZnpKdUErS3lSbkJCL3A1RzhYOXZEWkNEcXZWUkRydWlmZG13K2c4VFFKbWE1cGswd2gxQlBNK0Z4VEViQUlCcFlJNFFPYTlnQmVPOFNZM1Q4RmdVZVJsTkxWQnE4aFFNRDBBTEZPRkhVOXNCU29aejBpdmFad1lRPT0gcGF1bEBkcmFrZS5jego= --privileged defa/orangepi-zero

sync
echo "> Done."